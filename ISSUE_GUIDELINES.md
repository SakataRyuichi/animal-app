# GitHub Issue作成ガイドライン

**📚 ドキュメントインデックス**: [DOCUMENTATION_INDEX.md](./DOCUMENTATION_INDEX.md)

## 概要

このドキュメントは、ユーザーストーリーからGitHub Issueを作成する際のガイドラインです。一貫性のあるIssueを作成し、AIエージェントが効率的に実装できるようにします。

**関連ドキュメント**:
- [docs/stories/USER_STORIES.md](./docs/stories/USER_STORIES.md): モバイルアプリのユーザーストーリー
- [docs/stories/ADMIN_USER_STORIES.md](./docs/stories/ADMIN_USER_STORIES.md): 管理画面のユーザーストーリー
- [docs/stories/WEB_USER_STORIES.md](./docs/stories/WEB_USER_STORIES.md): 公式サイトのユーザーストーリー
- [docs/app-structure/APP_DIRECTORY_STRUCTURE.md](./docs/app-structure/APP_DIRECTORY_STRUCTURE.md): アプリディレクトリ構成と画面マッピング
- [docs/implementation/EPIC_OVERVIEW.md](./docs/implementation/EPIC_OVERVIEW.md): 各エピックの概要とストーリー一覧

---

## Issueテンプレートの選択

### 🤖 AI Task Template
**用途**: AIエージェント（Claude Code/Cursor）が直接読み取り、実装を開始するためのタスク

**使用場面**:
- ユーザーストーリー（US-XXX, ADM-XXX, WEB-XXX）の実装
- 既存機能の修正・拡張
- バグ修正（技術的な詳細が明確な場合）

**テンプレート**: `.github/ISSUE_TEMPLATE/ai-task.yml`

### ✨ Feature Request Template
**用途**: 新機能の提案や要件定義

**使用場面**:
- 新しい機能の提案
- ユーザーストーリーの追加提案
- 要件定義の段階

**テンプレート**: `.github/ISSUE_TEMPLATE/feature-request.yml`

---

## ユーザーストーリーからIssueへの変換方法

### ステップ1: ユーザーストーリーの確認

1. **ストーリーの特定**: `USER_STORIES.md`、`ADMIN_USER_STORIES.md`、または`WEB_USER_STORIES.md`から該当するストーリーを確認
2. **ストーリーIDの記録**: US-XXX、ADM-XXX、WEB-XXXの形式で記録
3. **関連情報の確認**:
   - 受け入れ基準
   - 体験価値
   - 使用シーン
   - 優先度
   - 画面パス（`APP_DIRECTORY_STRUCTURE.md`から）

### ステップ2: Issueの作成

#### 必須フィールドの記入

**🟢 概要 (Overview)**
```
US-009（トイレ記録）を実装します。
特に『受け入れ基準』にある視覚的なアイコン選択と、異常時のAI相談への導線を忘れずに。
ユーザーの体験価値（専門知識がなくても記録できる）を重視したUIを作成します。
```

**📚 関連ユーザーストーリー (User Story Reference)**
```
US-009（トイレ記録）
特に重視する点:
- 『受け入れ基準』: 視覚的なアイコン選択
- 『体験価値』: 専門知識がなくても記録できる
- 『使用シーン』: 散歩後のトイレタイムに記録
```

**📦 エピック (Epic)**
- ドロップダウンから該当するエピックを選択
- `EPIC_OVERVIEW.md`を参照してエピックを確認

**📱 画面パス (Screen Path)**
```
app/pets/[id]/activities/toilet.tsx
```
- `APP_DIRECTORY_STRUCTURE.md`から画面パスを確認
- 複数の画面がある場合は、すべて記載

**🔗 依存関係 (Dependencies)**
```
- US-068（ポイント獲得システム）: ポイント獲得機能が必要
- US-083（所持ポイント確認）: ポイント表示機能が必要
```
- 先に実装が必要なストーリーや機能を記載
- 依存関係がない場合は「なし」と記載

**📖 実装詳細・設計指示 (Technical Context)**
```
**対象テーブル/スキーマ**:
- `activities`テーブル（CONVEX_SCHEMA.md参照）
- `toilet_condition_masters`テーブル（種別ごとの選択肢）

**使用する関数名**:
- `createActivity` (mutation)
- `getActivitiesByPet` (query)
- `getToiletConditionMastersBySpecies` (query)

**参照ドキュメント**:
- `USER_STORIES.md`: US-009
- `CONVEX_SCHEMA.md`: activitiesテーブル定義、toilet_condition_mastersテーブル定義
- `DESIGN_DOCUMENT.md`: 4.1.3 活動ログ
- `.cursor/rules/PROJECT.md`: コードスタイル

**実装方針**:
- 関数型プログラミングを必須とする
- Tamaguiコンポーネントを使用（`@repo/ui`から）
- Convexの型安全性を確保
- ペットの種別に応じて選択肢を動的に表示
```

**✅ 受け入れ基準 (Acceptance Criteria)**
```
- [ ] トイレタイプ（おしっこ/うんち）をワンタップで選択できる
- [ ] 状態（硬い/柔らかい/下痢など）を視覚的なアイコンで選択できる
- [ ] ペットの種別に応じて選択肢が動的に変わる
- [ ] 異常な状態を記録した場合、AI相談への導線が表示される
- [ ] 記録後、タイムラインに表示される
- [ ] 型チェックとリントが通る
```
- ユーザーストーリーの「受け入れ基準」をチェックリスト形式で記載
- 実装完了の判定を容易にする

**🧪 テスト方針 (Testing Notes)**
```
- [ ] 型チェック: `pnpm typecheck`
- [ ] リント: `pnpm lint`
- [ ] 手動テスト: 実際のデバイスで動作確認
- [ ] エッジケース: 異常な状態の記録が正しく動作するか
- [ ] 種別ごとの選択肢が正しく表示されるか
```

### ステップ3: 依存関係の確認

1. **依存ストーリーの特定**: 実装前に完了している必要があるストーリーを確認
2. **依存Issueのリンク**: 依存するIssueがあれば、Issue番号を記載
3. **実装順序の確認**: 依存関係に基づいて実装順序を決定

### ステップ4: エピックへの紐づけ

1. **エピックの確認**: `EPIC_OVERVIEW.md`から該当するエピックを確認
2. **エピックフィールドの選択**: Issueテンプレートのエピックドロップダウンから選択
3. **エピック単位での管理**: エピック単位で進捗を管理

---

## 依存関係の記載方法

### 依存関係の種類

1. **技術的依存**: 他の機能やストーリーが先に実装されている必要がある
   - 例: US-083（所持ポイント確認）はUS-068（ポイント獲得システム）に依存

2. **データ依存**: 特定のテーブルやデータ構造が必要
   - 例: US-009（トイレ記録）は`toilet_condition_masters`テーブルに依存

3. **UI依存**: 特定の画面やコンポーネントが必要
   - 例: US-013-1（タイムラインビューの拡張）はUS-013（タイムライン表示）に依存

### 依存関係の記載例

```
**技術的依存**:
- US-068（ポイント獲得システム）: ポイント獲得機能が必要

**データ依存**:
- `toilet_condition_masters`テーブル: 種別ごとの選択肢データが必要

**UI依存**:
- US-013（タイムライン表示）: タイムライン画面が必要
```

---

## 画面パスの記載方法

### 画面パスの確認

1. **APP_DIRECTORY_STRUCTURE.mdを参照**: 各ストーリーに対応する画面パスを確認
2. **複数画面の場合**: すべての画面パスを記載
3. **動的ルート**: `[id]`などの動的パラメータを含む場合は、そのまま記載

### 画面パスの記載例

```
**単一画面**:
- `app/pets/[id]/activities/toilet.tsx`

**複数画面**:
- `app/points/index.tsx`（所持ポイント確認）
- `app/(tabs)/profile.tsx`（プロフィール画面にもポイント表示）

**動的ルート**:
- `app/pets/[id]/activities/[type].tsx`（typeはfeeding, toilet, walk, journal, careのいずれか）
```

---

## エピックの記載方法

### エピックの確認

1. **EPIC_OVERVIEW.mdを参照**: 各エピックの概要とストーリー一覧を確認
2. **エピックの選択**: Issueテンプレートのエピックドロップダウンから選択
3. **エピック単位での管理**: エピック単位で進捗を管理

### エピックの記載例

```
**エピック**: Epic 3: 活動ログ記録・リマインダー・広告表示

**関連ストーリー**:
- US-008: 食事記録
- US-009: トイレ記録
- US-010: 散歩記録
- US-011: 日記投稿
- US-012: ケア記録
- US-013: タイムライン表示
- US-014: リマインダー設定
- US-015: リマインダー通知と完了
- US-018: 広告表示（無料ユーザー）
```

---

## 受け入れ基準のチェックリスト化

### チェックリストの作成方法

1. **ユーザーストーリーの受け入れ基準を確認**: `USER_STORIES.md`から受け入れ基準を取得
2. **チェックリスト形式に変換**: 各基準を`- [ ]`形式で記載
3. **技術的な基準を追加**: 型チェック、リント、テストなどの技術的な基準を追加

### チェックリストの記載例

```
**機能的な基準**:
- [ ] トイレタイプ（おしっこ/うんち）をワンタップで選択できる
- [ ] 状態（硬い/柔らかい/下痢など）を視覚的なアイコンで選択できる
- [ ] ペットの種別に応じて選択肢が動的に変わる
- [ ] 異常な状態を記録した場合、AI相談への導線が表示される

**技術的な基準**:
- [ ] 型チェック: `pnpm typecheck`が通る
- [ ] リント: `pnpm lint`が通る
- [ ] テスト: 手動テストで動作確認済み
```

---

## 実装詳細の記載方法

### 技術的詳細の記載項目

1. **対象テーブル/スキーマ**: 使用するConvexテーブルやスキーマ
2. **使用する関数名**: 作成・修正するConvex関数名
3. **参照ドキュメント**: 関連するドキュメントへのリンク
4. **実装方針**: 実装の方向性や制約

### 実装詳細の記載例

```
**対象テーブル/スキーマ**:
- `activities`テーブル（CONVEX_SCHEMA.md参照）
- `toilet_condition_masters`テーブル（種別ごとの選択肢）
- `deletion`オブジェクトを使用した論理削除対応

**使用する関数名**:
- `createActivity` (mutation): 活動ログの作成
- `getActivitiesByPet` (query): ペットの活動ログ取得
- `getToiletConditionMastersBySpecies` (query): 種別ごとの選択肢取得

**参照ドキュメント**:
- `USER_STORIES.md`: US-009
- `CONVEX_SCHEMA.md`: activitiesテーブル定義、toilet_condition_mastersテーブル定義
- `DESIGN_DOCUMENT.md`: 4.1.3 活動ログ
- `.cursor/rules/PROJECT.md`: コードスタイル

**実装方針**:
- 関数型プログラミングを必須とする
- Tamaguiコンポーネントを使用（`@repo/ui`から）
- Convexの型安全性を確保
- ペットの種別に応じて選択肢を動的に表示
- 異常な状態を記録した場合、AI相談への導線を表示
```

---

## テスト方針の記載方法

### テスト方針の記載項目

1. **型チェック**: TypeScriptの型チェック
2. **リント**: ESLintのリントチェック
3. **手動テスト**: 実際のデバイスでの動作確認
4. **エッジケース**: 異常系のテスト

### テスト方針の記載例

```
**自動テスト**:
- [ ] 型チェック: `pnpm typecheck`が通る
- [ ] リント: `pnpm lint`が通る
- [ ] フォーマット: `pnpm format`が通る

**手動テスト**:
- [ ] 実際のデバイスで動作確認
- [ ] 種別ごとの選択肢が正しく表示されるか
- [ ] 異常な状態を記録した場合、AI相談への導線が表示されるか

**エッジケース**:
- [ ] ネットワークエラー時の処理
- [ ] オフライン時の処理
- [ ] 大量のデータがある場合のパフォーマンス
```

---

## Issue作成のチェックリスト

Issueを作成する際は、以下の項目を確認してください：

- [ ] ユーザーストーリーID（US-XXX, ADM-XXX, WEB-XXX）が記載されている
- [ ] エピックが選択されている
- [ ] 画面パスが記載されている（`APP_DIRECTORY_STRUCTURE.md`から確認）
- [ ] 依存関係が記載されている（依存関係がない場合は「なし」と記載）
- [ ] 受け入れ基準がチェックリスト形式で記載されている
- [ ] 実装詳細が記載されている（対象テーブル、関数名、参照ドキュメント）
- [ ] テスト方針が記載されている
- [ ] 優先度が選択されている
- [ ] フェーズが選択されている

---

## 参考例

### 例1: 基本的な実装タスク

**タイトル**: `[TASK]: US-009（トイレ記録）の実装`

**概要**:
```
US-009（トイレ記録）を実装します。
特に『受け入れ基準』にある視覚的なアイコン選択と、異常時のAI相談への導線を忘れずに。
ユーザーの体験価値（専門知識がなくても記録できる）を重視したUIを作成します。
```

**エピック**: Epic 3: 活動ログ記録・リマインダー・広告表示

**画面パス**: `app/pets/[id]/activities/toilet.tsx`

**依存関係**: なし

**受け入れ基準**:
```
- [ ] トイレタイプ（おしっこ/うんち）をワンタップで選択できる
- [ ] 状態（硬い/柔らかい/下痢など）を視覚的なアイコンで選択できる
- [ ] ペットの種別に応じて選択肢が動的に変わる
- [ ] 異常な状態を記録した場合、AI相談への導線が表示される
- [ ] 記録後、タイムラインに表示される
- [ ] 型チェックとリントが通る
```

### 例2: 依存関係がある実装タスク

**タイトル**: `[TASK]: US-083（所持ポイント確認）の実装`

**概要**:
```
US-083（所持ポイント確認）を実装します。
プロフィール画面とショップ画面に現在の所持ポイントを大きく表示します。
```

**エピック**: Epic 17: ゲーミフィケーション要素

**画面パス**:
- `app/points/index.tsx`（所持ポイント確認）
- `app/(tabs)/profile.tsx`（プロフィール画面にもポイント表示）

**依存関係**:
```
- US-068（ポイント獲得システム）: ポイント獲得機能が必要
- US-084（ポイント取得方法確認）: ポイント取得方法の説明が必要
```

**受け入れ基準**:
```
- [ ] プロフィール画面またはショップ画面に現在の所持ポイントが大きく表示される
- [ ] ポイント数が視覚的に分かりやすく表示される（例: 1,234pt）
- [ ] ポイントの増減がリアルタイムで反映される
- [ ] ポイント獲得履歴へのリンクが表示される（US-088の履歴画面へ）
- [ ] 型チェックとリントが通る
```

---

## 注意事項

### ユーザーストーリーの参照

- **必ず参照**: 実装前に必ず`USER_STORIES.md`、`ADMIN_USER_STORIES.md`、または`WEB_USER_STORIES.md`を参照してください
- **受け入れ基準の確認**: ユーザーストーリーの「受け入れ基準」を必ず確認してください
- **体験価値の重視**: ユーザーストーリーの「体験価値」を重視した実装を行ってください

### 画面パスの確認

- **APP_DIRECTORY_STRUCTURE.mdを参照**: 画面パスは`APP_DIRECTORY_STRUCTURE.md`から確認してください
- **動的ルートの記載**: `[id]`などの動的パラメータを含む場合は、そのまま記載してください

### 依存関係の確認

- **実装順序の確認**: 依存関係に基づいて実装順序を決定してください
- **依存Issueのリンク**: 依存するIssueがあれば、Issue番号を記載してください

### エピックの管理

- **エピック単位での管理**: エピック単位で進捗を管理してください
- **EPIC_OVERVIEW.mdを参照**: エピックの概要は`EPIC_OVERVIEW.md`から確認してください

---

**作成日**: 2026年2月1日  
**最終更新**: 2026年2月1日
