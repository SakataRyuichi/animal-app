# 15. album_itemsï¼ˆã‚¢ãƒ«ãƒãƒ ã‚¢ã‚¤ãƒ†ãƒ ï¼‰

**ğŸ“š ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**: [CONVEX_SCHEMA_INDEX.md](../CONVEX_SCHEMA_INDEX.md)

### 15. album_itemsï¼ˆã‚¢ãƒ«ãƒãƒ ã‚¢ã‚¤ãƒ†ãƒ ï¼‰

**ç›®çš„**: ã‚¢ãƒ«ãƒãƒ ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆæ´»å‹•ãƒ­ã‚°ãƒ»ç”»åƒï¼‰ã‚’ç´ä»˜ã‘ã‚‹ä¸­é–“ãƒ†ãƒ¼ãƒ–ãƒ«

**ä¸»è¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰**:
- `albumId`: ã‚¢ãƒ«ãƒãƒ ID
- `activityId`: æ´»å‹•ãƒ­ã‚°ï¼ˆæ—¥è¨˜ãªã©ï¼‰ã¸ã®å‚ç…§ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- `imageId`: ç”»åƒã¸ã®å‚ç…§ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- `order`: ã‚¢ãƒ«ãƒãƒ å†…ã§ã®è¡¨ç¤ºé †
- `addedAt`: è¿½åŠ æ—¥æ™‚

**ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹**:
- `by_album`: ã‚¢ãƒ«ãƒãƒ ã§ã®æ¤œç´¢ï¼ˆã‚¢ãƒ«ãƒãƒ å†…ã®ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§ï¼‰
- `by_activity`: æ´»å‹•ãƒ­ã‚°ã§ã®æ¤œç´¢ï¼ˆã“ã®æ´»å‹•ãƒ­ã‚°ãŒã©ã®ã‚¢ãƒ«ãƒãƒ ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ï¼‰
- `by_image`: ç”»åƒã§ã®æ¤œç´¢ï¼ˆã“ã®ç”»åƒãŒã©ã®ã‚¢ãƒ«ãƒãƒ ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‹ï¼‰

**ä½¿ç”¨ä¾‹**:
```typescript
// ã‚¢ãƒ«ãƒãƒ å†…ã®ã‚¢ã‚¤ãƒ†ãƒ ä¸€è¦§ã‚’å–å¾—
const items = await ctx.db
  .query("album_items")
  .withIndex("by_album", (q) => q.eq("albumId", albumId))
  .order("asc")
  .collect();

// å„ã‚¢ã‚¤ãƒ†ãƒ ã®è©³ç´°ã‚’å–å¾—
for (const item of items) {
  if (item.activityId) {
    const activity = await ctx.db.get(item.activityId);
    // æ´»å‹•ãƒ­ã‚°ã®å†…å®¹ã‚’è¡¨ç¤º
  }
  if (item.imageId) {
    const image = await ctx.db.get(item.imageId);
    // ç”»åƒã‚’è¡¨ç¤º
  }
}
```

---
